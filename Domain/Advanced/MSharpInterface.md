# MSharp Interfaces

As explained in [Business Domain - Basics: Interface](https://github.com/Geeksltd/MSharp.Docs/blob/master/Domain/Transient.md), an interface contains definitions for a group of related functionalities that a class or a struct can implement. All classes created with M# implement the [IEntity interface](https://github.com/Geeksltd/MSharp.Docs/blob/master/Domain/Advanced/IEntityInterface.md), allowing you to get access to common properties like `IsNew()` and use related features like the EntityManager (more details [here](https://github.com/Geeksltd/MSharp.Docs/blob/master/Domain/Advanced/TheRoleOfIsNew.md)).

M# also contains some other features that can be used in your applications. If you implement the following interfaces when needed, your project will have an architecture common to other projects and M# will provide you lots of fully tested extension methods.

## Data provider

These interfaces are for performing operations on the database and providing a data provider to the application.

#### IDataProvider
```C#
namespace Olive.Entities
{
    public interface IDataProvider
    {
        string ConnectionStringKey { get; set; }
        Type EntityType { get; }
        IDataAccess Access { get; }
        string ConnectionString { get; set; }

        Task<object> Aggregate(IDatabaseQuery query, AggregateFunction function, string propertyName);
        Task BulkInsert(IEntity[] entities, int batchSize);
        Task BulkUpdate(IEntity[] entities, int batchSize);
        Task<int> Count(IDatabaseQuery query);
        Task Delete(IEntity record);
        Task<int> ExecuteNonQuery(string command);
        Task<object> ExecuteScalar(string command);
        Task<IEntity> Get(object objectID);
        //
        // Summary:
        //     Returns a direct database criterion used to eager load associated objects.
        DirectDatabaseCriterion GetAssociationInclusionCriteria(IDatabaseQuery query, PropertyInfo association);
        Task<IEnumerable<IEntity>> GetList(IDatabaseQuery query);
        IDictionary<string, Tuple<string, string>> GetUpdatedValues(IEntity original, IEntity updated);
        string MapColumn(string propertyName);
        string MapSubquery(string path, string parent);
        //
        // Summary:
        //     Reads the many to many relation and returns the IDs of the associated objects.
        Task<IEnumerable<string>> ReadManyToManyRelation(IEntity instance, string property);
        Task Save(IEntity record);
        bool SupportValidationBypassing();
    }
}
```

#### IDataProviderFactory

```C#
namespace Olive.Entities
{
    public interface IDataProviderFactory
    {
        string ConnectionString { get; }

        IDataAccess GetAccess();
        IDataProvider GetProvider(Type type);
        //
        // Summary:
        //     Determines whether this data provider factory handles interface data queries.
        bool SupportsPolymorphism();
    }
}
```

## Application event

#### IAuditEvent
This interface allows you to store all application events (creation, update, task, exception...).

```C#
namespace Olive.Audit
{
    [LogEvents(false), CacheObjects(false)]
    public interface IAuditEvent : IEntity
    {
        DateTime Date { get; set; }
        string Event { get; set; }

        string ItemId { get; set; }
        string ItemType { get; set; }
        string ItemData { get; set; }

        string UserId { get; set; }
        string UserIp { get; set; }
    }
}
```

## Email

#### IEmailMessage
This interface is for storing email messages

```C#
namespace Olive.Email
{
    /// <summary>
    /// Represents an email generated by the application.
    /// </summary>
    [LogEvents(false), CacheObjects(false)]
    public interface IEmailMessage : IEntity
    {
        /// <summary>
        /// Gets or sets the body of this email.
        /// </summary>
        string Body { get; set; }

        /// <summary>Gets or sets the Date this email becomes sendable.</summary>
        DateTime SendableDate { get; set; }

        /// <summary>Gets or sets whether this email is HTML.</summary>
        bool Html { get; set; }

        /// <summary>Gets or sets the From Address of this email.</summary>
        string FromAddress { get; set; }

        /// <summary>Gets or sets the From Name for this email.</summary>
        string FromName { get; set; }

        /// <summary>Gets or sets the ReplyTo Address of this email.</summary>
        string ReplyToAddress { get; set; }

        /// <summary>Gets or sets the ReplyTo Name for this email.</summary>
        string ReplyToName { get; set; }

        /// <summary>
        /// Gets or sets the Subject of this email.
        /// </summary>
        string Subject { get; set; }

        /// <summary>
        /// Gets or sets the recipient of this email.
        /// </summary>
        string To { get; set; }

        /// <summary>
        /// Gets or sets the Attachments information for this email.
        /// </summary>
        string Attachments { get; set; }

        /// <summary>
        /// Gets or sets the Bcc recipients of this email.
        /// </summary>
        string Bcc { get; set; }

        /// <summary>
        /// Gets or sets the Bcc recipients of this email.
        /// </summary>
        string Cc { get; set; }

        /// <summary>
        /// Gets or sets the number of times sending this email has been tried.
        /// </summary>
        int Retries { get; set; }

        /// <summary>
        /// Gets or sets the VCalendar View of this email.
        /// </summary>
        string VCalendarView { get; set; }

        // -------------------------- Delivery settings override --------------------------

        /// <summary>
        /// Gets or sets whether SSL is enabled. If not set, the default config value will be used.
        /// </summary>
        bool? EnableSsl { get; set; }

        /// <summary>
        /// Gets or sets the Username to use for sending this email.
        /// If not set, the default config value will be used.
        /// </summary>
        string Username { get; set; }

        /// <summary>
        /// Gets or sets the Password to use for sending this email.
        /// If not set, the default config value will be used.
        /// </summary>
        string Password { get; set; }

        /// <summary>
        /// Gets or sets the Smtp host address to use for sending this email.
        /// If not set, the default config value will be used.
        /// </summary>
        string SmtpHost { get; set; }

        /// <summary>
        /// Gets or sets the Smtp port to use for sending this email.
        /// If not set, the default config value will be used. 
        /// </summary>
        int? SmtpPort { get; set; }
    }
}
```

#### IEmailTemplate

This interface is for email templates.

```C#
namespace Olive.Email
{
    /// <summary>
    /// Represents an instance of Email template entity type.
    /// </summary>
    public partial interface IEmailTemplate : IEntity
    {
        /* -------------------------- Properties -------------------------*/

        /// <summary>
        /// Gets or sets the value of Body on this Email template instance.
        /// </summary>
        string Body { get; set; }

        /// <summary>
        /// Gets or sets the value of Key on this Email template instance.
        /// </summary>
        string Key { get; set; }

        /// <summary>
        /// Gets or sets the value of MandatoryPlaceholders on this Email template instance.
        /// </summary>
        string MandatoryPlaceholders { get; set; }

        /// <summary>
        /// Gets or sets the value of Subject on this Email template instance.
        /// </summary>
        string Subject { get; set; }
    }
}
```

## GeoLocation

These interfaces are for Geolocation.

#### IGeoLocated

```C#
namespace Olive.GeoLocation
{
    public interface IGeoLocated
    {
        IGeoLocation GetLocation();
    }
}
```

#### IGeoLocation

```C#
namespace Olive.GeoLocation
{
    public interface IGeoLocation
    {
        double Longitude { get; }
        double Latitude { get; }
    }
}
```

## Globalization

For multi-lingual applications, you can use these interfaces to use M# globalization features.

#### ILanguage

This interface is for storing a language.

```C#
namespace Olive.Globalization
{
    public interface ILanguage : IEntity
    {
        string Name { get; }
        string IsoCode { get; }
        bool IsDefault { get; }
    }
}
```

#### IPhraseTranslation

This interface if for storing a translation.

```C#
namespace Olive.Globalization
{
    public interface IPhraseTranslation : IEntity
    {
        string Phrase { get; }
        string Translation { get; }
        ILanguage Language { get; }
    }
}
```

## Hierarchy

#### IHierarchy

This interface is useful for scenarios which contains data on many levels.

```C#
namespace Olive.Entities
{
    public interface IHierarchy : IEntity
    {
        IHierarchy GetParent();

        IEnumerable<IHierarchy> GetChildren();

        string Name { get; }
    }
}
```

## PDF

#### IHtml2PdfConverter

This interface is for PDF conversion.

```C#
namespace Olive.PDF
{
    public interface IHtml2PdfConverter
    {
        byte[] GetPdfFromUrlBytes(string url);
    }
}
```

## SMS

#### ISmsQueueItem

This interface is for storing SMS messages.

```C#
namespace Olive.SMS
{
    /// <summary>
    /// Represents a sendable SMS item generated by the application.
    /// </summary>
    [LogEvents(false)]
    [CacheObjects(false)]
    public interface ISmsQueueItem : IEntity
    {
        /// <summary>
        /// Gets or sets the date this SMS should be sent.
        /// </summary>
        DateTime Date { get; set; }

        /// <summary>
        /// Gets or sets the date when this SMS was successfully sent.
        /// </summary>
        DateTime? DateSent { get; set; }

        /// <summary>
        /// Gets or sets the Sender Name.
        /// </summary>
        string SenderName { get; set; }

        /// <summary>
        /// Gets or sets the SMS text.
        /// </summary>
        string Text { get; set; }

        /// <summary>
        /// Gets or sets the SMS recipient number.
        /// </summary>
        string To { get; set; }

        /// <summary>
        /// Gets or sets the number of times sending this email has been tried.
        /// </summary>
        int Retries { get; set; }

    }
}
```

#### ISMSSender

This interface is for sending SMS.

```C#
namespace Olive.SMS
{
    /// <summary>
    /// Represents a component that actually delivers SMS messages.
    /// This should be implemented for any 3rd party SMS gateway.
    /// </summary>
    public interface ISMSSender
    {
        /// <summary>
        /// Delivers the specified SMS message.
        /// The implementation of this method should not handle exceptions. Any exceptions will be logged by the engine.
        /// </summary>
        void Deliver(ISmsQueueItem sms);
    }
}
```

## Sorting

#### ISortable

```C#
namespace Olive.Entities
{
    /// <summary>
    /// Represents a sortable entity type.
    /// </summary>
    public interface ISortable : IEntity
    {
        int Order { get; set; }
    }
}
```